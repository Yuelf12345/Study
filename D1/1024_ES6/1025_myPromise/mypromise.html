<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

</body>
<script src="./myPromise.js"></script>
<script>
    // var p1 = new Promise((resolve,reject)=>{
    //     // resolve(111)
    //     // reject(222)
    // })
    // //pending fulfilled rejected
    // // console.log(p1);
    // p1.then(res=>{
    //     console.log("成功");
    // },err=>{
    //     console.log("失败");
    // })
{ 
    // setTimeout(()=>{
    //     console.log("setTimeout");
    // })
    //一、 三种状态
    let p2 = new myPromise((resolve,reject)=>{
        // resolve(222)
        // reject(222)
        // setTimeout(()=>{
            //调用onResolved
            resolve('myPromise')
        // },1000)
    })
    // console.log(p2);

    //二、 两个参数
    //保存onResolved  同步：先调用在保存  改异步：将调用延迟
    
        // p2.then(res=>{
        //     console.log("封装onResolved",res);
        // },err=>{
        //     console.log("封装onRejected",err);
        // })
    
    // 1. 多个then调用  只会执行最后一个
    /*
        p2.then(res=>{
            console.log(res);
        })
        p2.then(res=>{
            console.log(res);
        })
    */
    //2. 执行promise顺序     微任务 promise mutationObserver、process.nexTick 宏任务 setTimeout setInterval 
    // p2.then(res=>{
    //     console.log(res);
    // })

    //三、 三种返还值 then链式调用
    // let p = new myPromise((resolve,reject)=>{
    //     resolve("Success")
    // })
    // let res = p.then(res=>{
    //     console.log(res);
    //     return 111
    // }).then(res=>{
    //     console.log("??",res)
    // })

    //finally
    let p = new myPromise((resolve,reject)=>{
        setTimeout(()=>{
            reject('err')
        },1500)
    })
    p.then(res=>{
        console.log(res);
    },err=>{
        console.log(err);
    }).finally(()=>{
        console.log('结束了');
    })
} 


{
    // setTimeout(()=>{
    //     console.log("原生setTimeout----");
    // })
    let p3 = new Promise((resolve,reject)=>{
        // resolve(333)
        // reject(333)
        // setTimeout(()=>{
            resolve('原生promise----')
        // },1000)
    })
    // console.log(p3);
    /*
        p3.then(res=>{
            console.log("onResolved",res);
        },err=>{
            console.log("onRejected",err);
        })
    */
   /*
        p3.then(res=>{
            console.log(res);
        })
        p3.then(res=>{
            console.log(res);
        })
    */
    // p3.then(res=>{
    //     console.log(res);
    // })
    // let res = p3.then(res=>{
    //         console.log(res);
    //         // return 111;
    //         return new Promise(resolve=>{
    //             console.log(res)
    //             resolve('原生返还值----')
    //         }).then(res=>{
    //             console.log(res)
    //         })
    //     })
    // let p = new Promise((resolve,reject)=>{
    //     resolve("Success---")
    // })
    // let res = p.then(res=>{
    //     console.log(res);
    //     return 111
    // }).then(res=>{
    //     console.log("??---",res)
    // })

    //finally
    // let p = new Promise((resolve,reject)=>{
    //     // resolve("Success---")
    //     setTimeout(()=>{
    //         reject('err')
    //     },1500)
    // })
    // p.then(res=>{
    //     console.log(res);
    // }).finally(()=>{
    //     console.log('结束了---');
    // })
}
</script>
</html>